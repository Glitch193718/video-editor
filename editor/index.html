<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å—Ç—è–≥ —Ñ–∏–º–æ–∑–∏–∫–∞ - AI –í–∏–¥–µ–æ—Ä–µ–¥–∞–∫—Ç–æ—Ä</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #8A2BE2;
            --secondary: #00BFFF;
            --accent: #FF6B6B;
            --dark: #0F0F23;
            --light: #F0F8FF;
            --success: #4ECDC4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark), #1a1a2e);
            color: var(--light);
            min-height: 100vh;
            padding: 2rem;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .logo {
            font-size: 4rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .upload-area {
            border: 3px dashed var(--primary);
            border-radius: 15px;
            padding: 3rem;
            text-align: center;
            margin: 2rem 0;
            cursor: pointer;
            background: rgba(255,255,255,0.05);
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            background: rgba(138, 43, 226, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            margin: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .status {
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            text-align: center;
        }
        
        .status.success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid var(--success);
        }
        
        .status.error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid var(--accent);
        }
        
        .options {
            background: rgba(255,255,255,0.05);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }
        
        .option-group {
            margin: 1rem 0;
        }
        
        select {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid var(--primary);
            padding: 0.5rem;
            border-radius: 5px;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-video"></i>
            </div>
            <h1>–†–∞—Å—Ç—è–≥ —Ñ–∏–º–æ–∑–∏–∫–∞</h1>
            <p>–†–µ–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ FFmpeg</p>
        </header>

        <div class="upload-area" id="uploadArea">
            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; margin-bottom: 1rem;"></i>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∏–¥–µ–æ —Å—é–¥–∞</h3>
            <p>MP4, MOV, AVI, MKV (–¥–æ 100MB)</p>
            <input type="file" id="fileInput" accept="video/*" style="display: none;">
        </div>

        <div id="fileInfo" style="display: none;">
            <h4>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª:</h4>
            <p>–ò–º—è: <span id="fileName"></span></p>
            <p>–†–∞–∑–º–µ—Ä: <span id="fileSize"></span></p>
        </div>

        <div class="options">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏:</h3>
            
            <div class="option-group">
                <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                <select id="actionSelect">
                    <option value="compress">–°–∂–∞—Ç–∏–µ</option>
                    <option value="resize">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞</option>
                    <option value="format">–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞</option>
                </select>
            </div>
            
            <div class="option-group">
                <label>–ö–∞—á–µ—Å—Ç–≤–æ:</label>
                <select id="qualitySelect">
                    <option value="high">–í—ã—Å–æ–∫–æ–µ</option>
                    <option value="medium" selected>–°—Ä–µ–¥–Ω–µ–µ</option>
                    <option value="low">–ù–∏–∑–∫–æ–µ</option>
                </select>
            </div>
            
            <div class="option-group">
                <label>–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:</label>
                <select id="formatSelect">
                    <option value="mp4">MP4</option>
                    <option value="webm">WebM</option>
                </select>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress" id="progressBar"></div>
        </div>

        <div class="status" id="statusMessage">
            –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ...
        </div>

        <div style="text-align: center;">
            <button class="btn" id="processBtn" disabled>
                <i class="fas fa-magic"></i> –†–ï–ê–õ–¨–ù–ê–Ø –æ–±—Ä–∞–±–æ—Ç–∫–∞ FFmpeg
            </button>
        </div>

        <div id="serverStatus" style="text-align: center; margin-top: 2rem;">
            <p>–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞: <span id="serverStatusText">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
        </div>
    </div>

    <script>
        // üîß –ù–ê–°–¢–†–û–ô–ö–ê –°–ï–†–í–ï–†–ê - –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ô URL
        const SERVER_URL = 'https://dc5507717fe4f3ab6215938cf72e1061.serveo.net';
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const processBtn = document.getElementById('processBtn');
        const progressBar = document.getElementById('progressBar');
        const statusMessage = document.getElementById('statusMessage');
        const serverStatusText = document.getElementById('serverStatusText');

        let currentFile = null;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
        async function checkServer() {
            try {
                const response = await fetch(`${SERVER_URL}/status`);
                if (response.ok) {
                    serverStatusText.textContent = '‚úÖ –û–Ω–ª–∞–π–Ω';
                    serverStatusText.style.color = '#4CAF50';
                } else {
                    throw new Error('Server not responding');
                }
            } catch (error) {
                serverStatusText.textContent = '‚ùå –û—Ñ–ª–∞–π–Ω - –∑–∞–ø—É—Å—Ç–∏ server.py –∏ serveo';
                serverStatusText.style.color = '#f44336';
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        uploadArea.addEventListener('click', () => fileInput.click());
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFile(e.target.files[0]);
            }
        });

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.background = 'rgba(138, 43, 226, 0.2)';
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.background = 'rgba(255,255,255,0.05)';
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.background = 'rgba(255,255,255,0.05)';
            if (e.dataTransfer.files.length) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        processBtn.addEventListener('click', processVideo);

        // –§—É–Ω–∫—Ü–∏–∏
        function handleFile(file) {
            if (!file.type.startsWith('video/')) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª');
                return;
            }

            if (file.size > 100 * 1024 * 1024) {
                alert('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 100MB');
                return;
            }

            currentFile = file;
            
            fileName.textContent = file.name;
            fileSize.textContent = (file.size / (1024 * 1024)).toFixed(2) + ' MB';
            fileInfo.style.display = 'block';

            statusMessage.textContent = '‚úÖ –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ. –ú–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å!';
            statusMessage.className = 'status success';
            processBtn.disabled = false;
        }

        async function processVideo() {
            if (!currentFile) {
                alert('–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ');
                return;
            }

            processBtn.disabled = true;
            processBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –û–±—Ä–∞–±–æ—Ç–∫–∞...';
            statusMessage.textContent = 'üîÑ –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä...';
            statusMessage.className = 'status';
            progressBar.style.width = '20%';

            try {
                const formData = new FormData();
                formData.append('video', currentFile);
                formData.append('format', document.getElementById('formatSelect').value);
                formData.append('quality', document.getElementById('qualitySelect').value);
                formData.append('action', document.getElementById('actionSelect').value);

                progressBar.style.width = '40%';
                statusMessage.textContent = '‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ...';

                const response = await fetch(`${SERVER_URL}/process`, {
                    method: 'POST',
                    body: formData
                });

                progressBar.style.width = '80%';

                if (response.ok) {
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    
                    // –ê–≤—Ç–æ-—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'processed_' + currentFile.name;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    
                    progressBar.style.width = '100%';
                    statusMessage.textContent = '‚úÖ –í–∏–¥–µ–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∏ —Å–∫–∞—á–∞–Ω–æ!';
                    statusMessage.className = 'status success';
                    
                } else {
                    const error = await response.json();
                    throw new Error(error.error || 'Server error');
                }

            } catch (error) {
                console.error('Error:', error);
                statusMessage.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + error.message;
                statusMessage.className = 'status error';
            } finally {
                processBtn.disabled = false;
                processBtn.innerHTML = '<i class="fas fa-magic"></i> –†–ï–ê–õ–¨–ù–ê–Ø –æ–±—Ä–∞–±–æ—Ç–∫–∞ FFmpeg';
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.addEventListener('load', () => {
            checkServer();
            setInterval(checkServer, 30000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        });
    </script>
</body>
</html>
